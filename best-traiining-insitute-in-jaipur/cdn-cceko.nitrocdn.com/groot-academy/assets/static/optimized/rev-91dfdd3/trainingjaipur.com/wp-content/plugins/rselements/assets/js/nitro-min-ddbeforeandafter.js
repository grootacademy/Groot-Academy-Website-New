var ddbeforeandafter=function(i){var e={dragUI:'<div class="drag"><div class="draghandle"></div></div>',revealduration:.4,initialreveal:["50%",1],initialrevealeasing:"cubic-bezier(0.390, 0.575, 0.510, 1.650)",hidedragbardelay:1};var t="ontouchstart"in window||navigator.msMaxTouchPoints>0;function a(a){var n=i.extend({},e,a);n._imagesloaded=false;n._draghidetimer=null;var r=this;var o=i("#"+n.wrapperid);var s=o.find("div.before1:eq(0)");var d=o.find("div.after1:eq(0)");o.append(n.dragUI);var c=o.find("div.drag");var h=c.find("div.draghandle");var u={containerw:o.width(),dragbarw:c.width(),draghandlew:h.outerWidth()};n.defaultTimingFunction=c.css("transitionTimingFunction");var f=false;var l="mousemove.dragstart"+n.wrapperid+" touchmove.dragstart"+n.wrapperid;this.s=n;this.$container=o;this.$before=s;this.$after=d;this.$dragbar=c;this.$draghandle=h;this.dimensions=u;this._init();o.on("mousedown touchstart",function(i){f=true;if(i.target.tagName!="A")i.preventDefault()});o.on(t?"touchstart":"click",function(i){if(n._imagesloaded&&(f||t)){var i=i.type.indexOf("touch")!="-1"?i.originalEvent.changedTouches[0]:i;var e=i.pageX-o.offset().left;c.add(s).css({transitionTimingFunction:n.defaultTimingFunction,transitionDuration:n.revealduration+"s"});c.css({left:e});s.css({width:e});if(i.target.tagName!="A")i.preventDefault()}f=false});o.hover(function(){clearTimeout(n._draghidetimer);c.stop().animate({opacity:1})},function(){n._draghidetimer=setTimeout(function(){c.stop().animate({opacity:.3})},n.hidedragbardelay*1e3)});c.bind("click",function(i){i.stopPropagation()});c.bind("mousedown touchstart",function(e){if(!n._imagesloaded)return;var e=e.type.indexOf("touch")!=-1?e.originalEvent.changedTouches[0]:e;u=r.dimensions;var t=parseInt(c.css("left"));var a=o.offset().left;c.add(s).css({transitionDuration:"0s"});i(document).bind(l,function(i){var i=i.type.indexOf("touch")!="-1"?i.originalEvent.changedTouches[0]:i;var e=i.pageX-a-t;var n=e<0?Math.max(0,t+e):Math.min(u.containerw-u.dragbarw,t+e);c.css({left:n});s.css({width:n});return false});return false});i(document).bind("mouseup touchend",function(e){var e=e.type.indexOf("touch")!=-1?e.originalEvent.changedTouches[0]:e;i(document).unbind(l)});i(window).bind("resize",function(i){u.containerw=o.width();r._centerelement(c,h);s.find("img:eq(0)").css({width:u.containerw,height:"auto"});d.find("img:eq(0)").css({width:u.containerw,height:"auto"});r.unveil(n.initialreveal[0],n.initialreveal[1],n.initialrevealeasing)})}a.prototype={_centerelement:function(i,e,t,a){var n={parentw:i.width(),parenth:i.height(),targetw:e.outerWidth(),targeth:e.outerHeight()};e.css({left:n.parentw/2-n.targetw/2+(t||0),top:n.parenth/2-n.targeth/2+(a||0)})},_init:function(e){var t=this,a=this.s,n=this.$container,r=this.$before,o=this.$after,s=this.$dragbar,d=this.$draghandle;a._imagesloaded=false;if(e&&e.before1afterhtml){r.html(e.before1afterhtml[0]);o.html(e.before1afterhtml[1])}if(e&&e.dimensions){n.css({width:e.dimensions[0],height:e.dimensions[1]});this.dimensions={containerw:n.width(),dragbarw:s.width(),draghandlew:d.outerWidth()}}this._centerelement(s,d);this.unveil(0,0);clearTimeout(a._draghidetimer);s.css({opacity:.3});var c=this.$before.css({opacity:.5}).find("img:eq(0)").css({width:this.dimensions.containerw,height:"auto"});var h=this.$after.css({opacity:0}).find("img:eq(0)").css({width:this.dimensions.containerw,height:"auto"});var u=[i.Deferred(),i.Deferred()];if(c.prop("complete")===true)u[0].resolve();if(h.prop("complete")===true)u[1].resolve();c.on("load error",function(){u[0].resolve()});h.on("load error",function(){u[1].resolve()});i.when(u[0],u[1]).done(function(){a._imagesloaded=true;o.css({opacity:1});r.animate({opacity:1},function(){s.animate({opacity:1},function(){t.unveil(a.initialreveal[0],a.initialreveal[1],a.initialrevealeasing)})})})},reload:function(i,e){var t={beforeafterhtml:i,dimensions:e};this._init(t)},unveil:function(i,e,t){var a=this.s,n=this.$container,r=this.$before,o=this.$dragbar,s=this.dimensions,i=parseInt(i);i=i<0?0:i>100?100:i;var e=(typeof e!="undefined"?e:a.revealduration)+"s";var d=t||a.defaultTimingFunction;i=100-i;var c=(s.containerw-s.dragbarw)*i/100;o.add(r).css({transitionTimingFunction:d,transitionDuration:e});o.css({left:c});r.css({width:c})}};return a}(jQuery);